(function(){tinymce.PluginManager.requireLangPack("EasyPhotoAlbum");tinymce.PluginManager.add("EasyPhotoAlbum",function(E,D){var C;E.addButton("epa_insert",{tooltip:E.getLang("epa.dlg_title"),icon:"epa-dashicons epa-dashicons-insert-album",cmd:"epa_insert_album",});function B(G){if(undefined==C){var F="action=epa_get_albums&_ajax_nonce="+E.getLang("epa.nonce");tinymce.util.XHR.send({url:window.ajaxurl,data:F,content_type:"application/x-www-form-urlencoded",type:"POST",success:function(K){var I=[],J=tinymce.util.JSON.parse(K);for(var H=0;H<J.length;H++){I.push({text:J[H].title,value:J[H].id})}C=I;G(I)}})}else{G(C)}}function A(F){var G;G=E.windowManager.open({inline:true,id:"epa-insert",title:E.getLang("epa.dlg_title","Insert a photo album"),body:[{name:"albumid",type:"listbox",label:E.getLang("epa.select_album","Select an album to include"),autofocus:true,value:0,values:F},{name:"showtitle",type:"checkbox",text:E.getLang("epa.show_title","Show the title"),},{name:"displaylabel",type:"label",text:E.getLang("epa.display_label","Display album like:"),},{name:"excerpt",type:"radio",style:"cursor: pointer;",text:E.getLang("epa.excerpt","Excerpt"),checked:true,onClick:function(H){if(G.find("#excerpt").checked()){G.find("#full").checked(false)}else{G.find("#full").checked(true)}}},{name:"full",type:"radio",text:E.getLang("epa.full","Full album"),style:"cursor: pointer;",onClick:function(H){if(G.find("#full").checked()){G.find("#excerpt").checked(false)}else{G.find("#excerpt").checked(true)}}}],buttons:[{text:E.getLang("epa.insert","Insert"),onclick:"submit",classes:"btn primary"},{text:E.getLang("epa.cancel","Cancel"),onclick:"close"}],onSubmit:function(J){var H,K,I="excerpt";if(J.data.showtitle){K="true"}else{K="false"}if(J.data.full){I="full"}H='[epa-album id="'+J.data.albumid+'" title="'+K+'" display="'+I+'"]';E.selection.setContent(H)}})}E.addCommand("epa_insert_album",function(){var F=E.windowManager.open({inline:true,title:E.getLang("epa.title_loading","Loading..."),body:[{type:"label",text:E.getLang("epa.loading","Loading albums...")}],buttons:[{hidden:true}]});B(function(G){F.close();A(G)})})})})();